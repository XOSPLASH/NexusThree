<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, viewport-fit=cover" />
    <title>NexusThree</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <script defer src="config.js"></script>
    <script defer src="board.js"></script>
    <script defer src="entities.js"></script>
    <script defer src="runes.js"></script>
    <script defer src="abilities/index.js"></script>
    <script defer src="abilities/warrior.js"></script>
    <script defer src="abilities/archer.js"></script>
    <script defer src="abilities/mage.js"></script>
    <script defer src="abilities/paladin.js"></script>
    <script defer src="abilities/berserker.js"></script>
    <script defer src="abilities/alchemist.js"></script>
    <script defer src="abilities/builder.js"></script>
    <script defer src="abilities/rogue.js"></script>
    <script defer src="abilities/cleric.js"></script>
    <script defer src="abilities/firecaller.js"></script>
    <script defer src="abilities/magnet.js"></script>
    <script defer src="abilities/avenger.js"></script>
    <script defer src="abilities/necromancer.js"></script>
    <script defer src="abilities/skeleton.js"></script>
    <script defer src="abilities/hex.js"></script>
    <script defer src="abilities/sludge.js"></script>
    <script defer src="abilities/druid.js"></script>
    <script defer src="game.js"></script>
    <script>
      (function() {
        function setViewportScale(scale) {
          var meta = document.querySelector('meta[name="viewport"]');
          if (!meta) return;
          var s = Math.max(0.5, Math.min(1, scale || 1));
          meta.setAttribute('content', 'width=device-width, initial-scale=' + s + ', minimum-scale=' + s + ', maximum-scale=1, viewport-fit=cover');
        }
        function recalcViewportScale() {
          var isLandscape = window.matchMedia('(orientation: landscape)').matches;
          if (!isLandscape) { setViewportScale(1); return; }
          var main = document.querySelector('.app-main');
          if (!main) { setViewportScale(1); return; }
          var W = window.innerWidth || document.documentElement.clientWidth;
          var layoutW = Math.ceil(main.scrollWidth);
          var scale = W / layoutW;
          setViewportScale(scale);
        }
        window.addEventListener('orientationchange', recalcViewportScale);
        window.addEventListener('resize', recalcViewportScale);
        document.addEventListener('DOMContentLoaded', recalcViewportScale);
      })();
    </script>
  </head>
  <body>
    <header class="app-header">
      <h1 class="title">NexusThree</h1>
    </header>

    <main class="app-main">
      <!-- Left: Unit Details Panel -->
      <aside class="side left">
        <div id="unit-panel" class="panel">
          <div class="panel-title">Unit Details</div>
          <div class="unit-header">
            <div id="unit-icon" class="unit-icon">â€”</div>
            <div class="unit-info">
              <div id="unit-name" class="unit-name">None selected</div>
              <div id="unit-desc" class="unit-desc">Select a unit to view details.</div>
            </div>
          </div>
          <div class="panel-subtitle">Stats</div>
          <ul id="stats-list" class="list"></ul>
        </div>
        <div id="abilities-panel" class="panel">
          <div class="panel-title">Abilities</div>
          <ul id="abilities-list" class="list"></ul>
          <button id="ability-btn" class="btn btn-primary" style="display:none">Use Ability</button>
        </div>
      </aside>

      <!-- Center: Turn bar + Grid -->
      <div class="center-wrap">
        <div class="turnbar">
          <div id="turn-indicator" class="turn">Turn: Player</div>
          <div id="energy-bar" class="energy-bar">
            <div id="energy-player" class="energy-chip">Player: 0/0</div>
            <div id="energy-ai" class="energy-chip">AI: 0/0</div>
          </div>
          <button id="end-turn" class="btn btn-danger">End Turn</button>
        </div>
        <div id="grid" class="grid" aria-label="10 by 10 grid"></div>
      </div>

      <!-- Right: Unit Shop Panel -->
      <aside class="side right">
        <div id="buy-panel" class="panel">
          <div class="panel-title">Unit Shop</div>
          <div id="buy-controls"></div>
          <button id="buy-cancel" class="btn btn-secondary" style="display:none">Cancel Placement</button>
        </div>
      </aside>
    </main>

  </body>
  </html>
